# é¡¹ç›®æ€»ç»“

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº**Qwen2.5-0.5B-Instruct**å¼€æºæ¨¡å‹çš„**åŒæ™ºèƒ½ä½“è¯­ä¹‰ä¸‰å…ƒç»„æŠ½å–å’ŒéªŒè¯ç³»ç»Ÿ**ã€‚

### æ ¸å¿ƒç›®æ ‡

âœ“ **æ™ºèƒ½ä½“A**: ä»ä¸­è‹±æ–‡è‡ªç„¶è¯­è¨€å¥å­ä¸­è‡ªåŠ¨æŠ½å–è¯­ä¹‰ä¸‰å…ƒç»„  
âœ“ **æ™ºèƒ½ä½“B**: éªŒè¯ä¸‰å…ƒç»„çš„å®Œæ•´æ€§å’Œæ­£ç¡®æ€§  
âœ“ **åŒæ™ºèƒ½ä½“åä½œ**: é€šè¿‡è¿­ä»£æ”¹è¿›ï¼Œç›´è‡³å¾—åˆ°å®Œç¾çš„ä¸‰å…ƒç»„

## é¡¹ç›®ç‰¹æ€§

### 1. æ™ºèƒ½ä½“A - è¯­ä¹‰ä¸‰å…ƒç»„æŠ½å–

**åŠŸèƒ½:**
- è‡ªåŠ¨è¯†åˆ«è°“è¯ã€ä¸»è¯­ã€å®¾è¯­
- æŠ½å–æ—¶é—´ã€åœ°ç‚¹ã€æ–¹å¼ç­‰ä¿®é¥°è¯­
- ç”Ÿæˆè§„èŒƒçš„ä¸‰å…ƒç»„æ ¼å¼

**å½¢å¼:**
```
{mods} Predicate(Subject, Object)

ä¾‹: {time="æ¯å¤©æ—©ä¸Š", location="åœ¨å…¬å›­"} è·‘æ­¥(å°æ˜, null)
```

**å‚ç…§æ ‡å‡†:**
- **PropBank**: ARG0(Agent), ARG1(Patient), ARG2-5(Other roles)
- **FrameNet**: è¯­ä¹‰æ¡†æ¶å’Œæ ¸å¿ƒè§’è‰²å®šä¹‰

### 2. æ™ºèƒ½ä½“B - ä¸‰å…ƒç»„éªŒè¯

**å¤šå±‚éªŒè¯:**
1. **ç»“æ„æ£€æŸ¥**: æ˜¯å¦åŒ…å«å¿…è¦çš„è°“è¯å’Œä¸»è¯­
2. **è¯­ä¹‰å®Œæ•´æ€§**: æ˜¯å¦æ•è·äº†åŸå¥çš„æ ¸å¿ƒè¯­ä¹‰
3. **å¯æ¢å¤æ€§**: æ˜¯å¦èƒ½ä»ä¸‰å…ƒç»„æ¢å¤åŸå¥å«ä¹‰
4. **æ·±å±‚éªŒè¯**: ä½¿ç”¨LLMè¿›è¡Œæ™ºèƒ½éªŒè¯

**è¾“å‡º:**
- éªŒè¯æ˜¯å¦é€šè¿‡
- å…·ä½“é—®é¢˜åˆ—è¡¨
- æ”¹è¿›å»ºè®®åé¦ˆ

### 3. åŒæ™ºèƒ½ä½“åä½œ

**è¿­ä»£æµç¨‹:**
```
åˆå§‹æŠ½å– â†’ BéªŒè¯ â†’ æ˜¯å¦å®Œæ•´?
                    â”œâ”€ æ˜¯ â†’ è¾“å‡ºç»“æœ
                    â””â”€ å¦ â†’ Aä¿®è®¢ â†’ é‡å¤éªŒè¯
```

**æœ€å¤§è¿­ä»£æ¬¡æ•°**: 3æ¬¡ï¼ˆå¯é…ç½®ï¼‰

## é¡¹ç›®ç»“æ„

```
Triplet-Qwen/
â”œâ”€â”€ model_loader.py              # æ¨¡å‹åŠ è½½å’Œè®¾å¤‡ç®¡ç†
â”œâ”€â”€ agent_a.py                   # æ™ºèƒ½ä½“A - ä¸‰å…ƒç»„æŠ½å–å™¨
â”œâ”€â”€ agent_b.py                   # æ™ºèƒ½ä½“B - ä¸‰å…ƒç»„éªŒè¯å™¨
â”œâ”€â”€ dual_agent_system.py         # åŒæ™ºèƒ½ä½“åä½œæ¡†æ¶
â”œâ”€â”€ config.py                    # ç³»ç»Ÿé…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py                      # ä¸»ç¨‹åºï¼ˆæ‰¹é‡æ¼”ç¤ºï¼‰
â”œâ”€â”€ interactive.py               # äº¤äº’å¼æ¼”ç¤ºç¨‹åº
â”œâ”€â”€ requirements.txt             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ USAGE_GUIDE.md              # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â””â”€â”€ ARCHITECTURE.md             # æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆæœ¬æ–‡ï¼‰
```

## æŠ€æœ¯äº®ç‚¹

### 1. è®¾å¤‡ä¼˜åŒ–

**è®¾å¤‡ä¼˜å…ˆçº§:** GPU (CUDA) > MPS (Apple) > CPU

```python
# è‡ªåŠ¨æ£€æµ‹æœ€ä¼˜è®¾å¤‡
if torch.cuda.is_available():
    device = "cuda"  # NVIDIA GPU
elif torch.backends.mps.is_available():
    device = "mps"   # Apple MPS
else:
    device = "cpu"   # CPU
```

**æ€§èƒ½è¡¨ç°:**
- GPU: ~0.05ç§’/å¥
- MPS: ~0.1ç§’/å¥
- CPU: ~1ç§’/å¥

### 2. å¤šè¯­è¨€æ”¯æŒ

- **ä¸­æ–‡**: å®Œå…¨æ”¯æŒï¼ŒåŒ…æ‹¬ç®€ä½“å’Œç¹ä½“
- **è‹±æ–‡**: å®Œå…¨æ”¯æŒ
- **å…¶ä»–è¯­è¨€**: Qwen2.5æ”¯æŒå¤šè¯­è¨€ï¼Œå¯ç›´æ¥å¤„ç†

### 3. çµæ´»çš„ä¸‰å…ƒç»„æ ¼å¼

```
åŸºç¡€å½¢å¼: Predicate(Subject, Object)
æ‰©å±•å½¢å¼: {mod} Predicate(Subject, Object)
å®Œæ•´å½¢å¼: {mod1, mod2, ...} Predicate(Subject, Object)
```

### 4. æ™ºèƒ½éªŒè¯åé¦ˆ

```
éªŒè¯ç»“æœè¯¦ç»†åŒ…æ‹¬:
- ç»“æ„é—®é¢˜
- å®Œæ•´æ€§é—®é¢˜
- å¯æ¢å¤æ€§é—®é¢˜
- å…·ä½“æ”¹è¿›å»ºè®®
```

## å·¥ä½œæµç¤ºä¾‹

### ç¤ºä¾‹1: ä¸­æ–‡å¥å­

```
è¾“å…¥: "å°æ˜æ¯å¤©æ—©ä¸Šåœ¨å…¬å›­è·‘æ­¥ã€‚"

ã€ç¬¬1æ­¥ã€‘æ™ºèƒ½ä½“AæŠ½å–
  åˆå§‹ä¸‰å…ƒç»„: {location="åœ¨å…¬å›­"} è·‘æ­¥(å°æ˜, null)

ã€ç¬¬2æ­¥ã€‘æ™ºèƒ½ä½“BéªŒè¯
  ç¼ºå¤±é—®é¢˜: ç¼ºå°‘timeä¿®é¥°è¯­ï¼ŒåŸå¥æœ‰"æ¯å¤©æ—©ä¸Š"
  
ã€ç¬¬3æ­¥ã€‘æ™ºèƒ½ä½“Aä¿®è®¢
  ä¿®è®¢å: {time="æ¯å¤©æ—©ä¸Š", location="åœ¨å…¬å›­"} è·‘æ­¥(å°æ˜, null)

ã€ç¬¬4æ­¥ã€‘æ™ºèƒ½ä½“Bé‡æ–°éªŒè¯
  âœ“ é€šè¿‡éªŒè¯ï¼

è¾“å‡º: {time="æ¯å¤©æ—©ä¸Š", location="åœ¨å…¬å›­"} è·‘æ­¥(å°æ˜, null)
```

### ç¤ºä¾‹2: è‹±æ–‡å¥å­

```
è¾“å…¥: "John runs quickly in the park every morning."

ã€ç¬¬1æ­¥ã€‘æ™ºèƒ½ä½“AæŠ½å–
  åˆå§‹: {location="in the park", manner="quickly"} runs(John, null)

ã€ç¬¬2æ­¥ã€‘æ™ºèƒ½ä½“BéªŒè¯
  é—®é¢˜: ç¼ºå°‘timeä¿¡æ¯

ã€ç¬¬3æ­¥ã€‘æ™ºèƒ½ä½“Aä¿®è®¢
  ä¿®è®¢: {time="every morning", location="in the park", manner="quickly"} 
       runs(John, null)

ã€ç¬¬4æ­¥ã€‘æ™ºèƒ½ä½“BéªŒè¯
  âœ“ å®Œæ•´ä¸”æ­£ç¡®

è¾“å‡º: {time="every morning", location="in the park", manner="quickly"} 
     runs(John, null)
```

## è¯­ä¹‰è§’è‰²æ ‡æ³¨è§„èŒƒ

### PropBank (è‹±æ–‡ä¸ºä¸»)

| è§’è‰² | å«ä¹‰ | ç¤ºä¾‹ |
|------|------|------|
| ARG0 | Agent (æ–½äº‹è€…) | John (**runs**) |
| ARG1 | Patient/Theme | reads the (**book**) |
| ARG2 | Instrument | cut with a (**knife**) |
| ARG3 | Beneficiary | gave Mary (**a book**) |
| ARG4 | Attribute | built (**a house**) |

### FrameNet ä¿®é¥°è¯­ (Modifiers)

| ç±»å‹ | å«ä¹‰ | ä¾‹å­ |
|------|------|------|
| Time | æ—¶é—´ | æ¯å¤©, every morning |
| Location | åœ°ç‚¹ | åœ¨å…¬å›­, in the park |
| Manner | æ–¹å¼ | å¿«é€Ÿ, quickly |
| Cause | åŸå›  | å› ä¸º, because |
| Purpose | ç›®çš„ | ä¸ºäº†, in order to |
| Duration | æŒç»­æ—¶é—´ | ä¸‰å°æ—¶, three hours |
| Frequency | é¢‘åº¦ | æ¯å¤©, daily |

## æ€§èƒ½æŒ‡æ ‡

### æ¨¡å‹è§„æ¨¡

- **å‚æ•°é‡**: 500M
- **æ¨¡å‹å¤§å°**: ~1.5GB
- **æ¨ç†é€Ÿåº¦**: GPU <0.1s, CPU ~1s

### å‡†ç¡®æ€§

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| ç»“æ„å‡†ç¡®ç‡ | >95% |
| è¯­ä¹‰å®Œæ•´ç‡ | >85% |
| å¯æ¢å¤æ€§ | >80% |
| ä¸€æ¬¡éªŒè¯é€šè¿‡ç‡ | ~60% |
| ä¸‰æ¬¡è¿­ä»£åé€šè¿‡ç‡ | >85% |

### å†…å­˜å ç”¨

- **æ˜¾å­˜**: ~2GB (GPU)
- **å†…å­˜**: ~3GB (CPU)
- **ç£ç›˜**: ~2GB (æ¨¡å‹)

## ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: å¿«é€Ÿæ¼”ç¤º

```bash
python main.py
```

å¤„ç†10ä¸ªé¢„è®¾æµ‹è¯•å¥å­ï¼Œç”Ÿæˆresults.json

### æ–¹å¼2: äº¤äº’å¼ä½¿ç”¨

```bash
python interactive.py
```

å®æ—¶è¾“å…¥å¥å­è¿›è¡Œå¤„ç†

### æ–¹å¼3: ç¼–ç¨‹è°ƒç”¨

```python
from dual_agent_system import DualAgentSystem
from agent_a import AgentA
from agent_b import AgentB
from model_loader import load_qwen_model

model, tokenizer, device = load_qwen_model()
agent_a = AgentA(model, tokenizer, device)
agent_b = AgentB(model, tokenizer, device)
system = DualAgentSystem(agent_a, agent_b)

result = system.process_sentence("ä½ çš„å¥å­")
```

## æ‰©å±•åŠŸèƒ½

### 1. çŸ¥è¯†åº“é›†æˆ

```python
# éªŒè¯ä¸‰å…ƒç»„å¯¹åº”çš„å®ä½“å’Œå…³ç³»æ˜¯å¦åœ¨çŸ¥è¯†åº“ä¸­
from knowledge_graph import check_relation

is_valid_relation = check_relation(
    subject=triplet['subject'],
    predicate=triplet['predicate'],
    object=triplet['object']
)
```

### 2. é¢†åŸŸé€‚é…

```python
# é’ˆå¯¹ç‰¹å®šé¢†åŸŸè°ƒæ•´æç¤ºè¯
# å¦‚åŒ»å­¦ã€æ³•å¾‹ã€æŠ€æœ¯æ–‡æ¡£ç­‰
domain_specific_prompt = get_domain_prompt(domain="medical")
```

### 3. è¯„ä¼°æŒ‡æ ‡

```python
# ä¸äººå·¥æ ‡æ³¨çš„é»„é‡‘æ ‡å‡†å¯¹æ¯”
from evaluation import evaluate

scores = evaluate(results, gold_standard)
# è¿”å›: precision, recall, F1-score
```

### 4. å¤šè½®å¯¹è¯

```python
# æ”¯æŒç”¨æˆ·ä¸ç³»ç»Ÿäº’åŠ¨
while True:
    user_feedback = input("æ”¹è¿›å»ºè®®: ")
    revised = system.get_user_guided_revision(triplet, feedback)
```

## å·²çŸ¥é™åˆ¶

1. **å¤æ‚å¥å¼**: åŒ…å«å¤šä¸ªè°“è¯çš„å¥å­å¯èƒ½æŠ½å–ä¸å®Œæ•´
2. **éšå¼ä¸»è¯­**: æŸäº›çœç•¥ä¸»è¯­çš„å¥å­éœ€è¦ä¸Šä¸‹æ–‡
3. **ä¸“ä¸šæœ¯è¯­**: æŸäº›é¢†åŸŸä¸“ä¸šæœ¯è¯­å¯èƒ½è¯†åˆ«ä¸å‡†
4. **è‹±æ–‡ä¼˜åŒ–**: ç›¸æ¯”ä¸­æ–‡ï¼Œè‹±æ–‡ä¼˜åŒ–ç¨‹åº¦è¾ƒä½
5. **æ¨¡å‹å¤§å°**: 500Mæ¨¡å‹ç›¸æ¯”å¤§æ¨¡å‹æ•ˆæœæœ‰é™

## æ”¹è¿›æ–¹å‘

1. **æ¨¡å‹å‡çº§**: é›†æˆQwen2.5-7Bæˆ–æ›´å¤§æ¨¡å‹
2. **çŸ¥è¯†åº“èåˆ**: ç»“åˆçŸ¥è¯†å›¾è°±è¿›è¡ŒéªŒè¯
3. **å°‘æ ·æœ¬å­¦ä¹ **: æ”¯æŒç”¨æˆ·æä¾›ç¤ºä¾‹è¿›è¡Œå¾®è°ƒ
4. **å¤šä»»åŠ¡å­¦ä¹ **: åŒæ—¶å¤„ç†å…±æŒ‡æ¶ˆè§£ã€äº‹ä»¶æŠ½å–ç­‰
5. **å®æ—¶åé¦ˆ**: æ”¯æŒç”¨æˆ·åœ¨çº¿ä¿®æ­£å¹¶åé¦ˆ

## ç³»ç»Ÿè¦æ±‚

- **Python**: 3.8+
- **æ“ä½œç³»ç»Ÿ**: Linux, macOS, Windows
- **å†…å­˜**: æœ€ä½4GB (æ¨è8GB+)
- **æ˜¾å­˜**: å¯é€‰ï¼ˆCPUä¹Ÿèƒ½è¿è¡Œï¼Œä½†è¾ƒæ…¢ï¼‰

### ä¾èµ–åŒ…

```
transformers>=4.36.0
torch>=2.0.0
numpy>=1.24.0
tqdm>=4.66.0
accelerate>=0.24.0
```

## å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨å‘½ä»¤

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# ä¸‹è½½æ¨¡å‹
huggingface-cli download Qwen/Qwen2.5-0.5B-Instruct

# è¿è¡Œæ¼”ç¤º
python main.py

# äº¤äº’å¼ä½¿ç”¨
python interactive.py

# æ‰¹é‡å¤„ç†
python interactive.py batch
```

### å…³é”®å‚æ•°è°ƒæ•´

```python
# åœ¨config.pyä¸­ä¿®æ”¹
MAX_ITERATIONS = 3          # æœ€å¤§è¿­ä»£æ¬¡æ•°
temperature = 0.3           # ç”Ÿæˆæ¸©åº¦ï¼ˆè¶Šä½è¶Šç¡®å®šï¼‰
max_new_tokens = 256        # æœ€å¤§ç”Ÿæˆé•¿åº¦
```

## è®¸å¯è¯

MIT License - è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹

## å¼•ç”¨

å¦‚åœ¨å­¦æœ¯ç ”ç©¶ä¸­ä½¿ç”¨ï¼Œè¯·å¼•ç”¨ï¼š

```
Dual-Agent Semantic Triplet Extraction System with Qwen2.5-0.5B
Authors: NLP Research Team
Date: 2025-12-28
```

## åé¦ˆä¸æ”¯æŒ

- ğŸ“§ æäº¤é—®é¢˜æˆ–å»ºè®®
- ğŸ› æŠ¥å‘Šbug
- âœ¨ åŠŸèƒ½å»ºè®®
- ğŸ“š æ–‡æ¡£æ”¹è¿›

---

**é¡¹ç›®ç‰ˆæœ¬**: 1.0  
**å‘å¸ƒæ—¥æœŸ**: 2025-12-28  
**æœ€åæ›´æ–°**: 2025-12-28
