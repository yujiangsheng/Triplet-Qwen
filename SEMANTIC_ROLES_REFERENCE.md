"""
语义角色参考手册

本文档详细说明PropBank和FrameNet中定义的语义角色，
以及在Triplet-Qwen系统中的应用。
"""

# ============================================================================
# 第一部分: PropBank语义角色标准
# ============================================================================

"""
PropBank (Proposition Bank) 定义的语义论元：

=== 核心论元 (Core Arguments) ===

ARG0 - Agent (施事者/主体)
    语义角色: 有意执行动作的实体
    中文表现形式: 通常是主语
    示例:
    - "小明跑步。" → 小明 = ARG0 (跑步)
    - "他推动了改革。" → 他 = ARG0 (推动)
    PropBank: 动词所有格式中，ARG0是最常见的核心论元
    
ARG1 - Patient/Theme (受事者/主题)
    语义角色: 遭受动作、改变或移动的实体
    中文表现形式: 通常是宾语
    示例:
    - "小明踢球。" → 球 = ARG1 (踢)
    - "他写了一本书。" → 一本书 = ARG1 (写)
    
ARG2 - Instrument/Beneficiary (工具/受益者)
    语义角色: 执行动作所使用的工具或从中受益的实体
    中文表现形式: "用...的"结构或"为...的"结构
    示例:
    - "她用钉子钉住木板。" → 钉子 = ARG2 (钉住) [工具]
    - "我为他买了书。" → 他 = ARG2 (买) [受益者]

ARG3 - Start Point/Beneficiary/Attribute (起点/属性)
    语义角色: 事件的起始点或涉及的属性
    中文表现形式: "从...开始"或形容词修饰
    示例:
    - "从北京到上海。" → 北京 = ARG3 (去)
    - "他变成了医生。" → 医生 = ARG3 (变成)

ARG4 - End Point (终点)
    语义角色: 事件的终止点或目标
    中文表现形式: "到...为止"
    示例:
    - "从北京到上海。" → 上海 = ARG4 (去)

=== 附加论元 (Adjunct Arguments, ArgM-*) ===

这些是非核心的修饰性论元，通常作为谓词的修饰语。

ArgM-TMP (时间/Temporal)
    含义: 动作发生的时间或持续时间
    中文表现形式: 时间词或时间短语
    示例:
    - "每天"、"昨天下午"、"2024年1月"、"一个小时内"
    
ArgM-LOC (地点/Locative)
    含义: 动作发生的地点或空间位置
    中文表现形式: 地点词或地点短语
    示例:
    - "在公园"、"北京"、"办公室里"、"学校门口"
    
ArgM-MNR (方式/Manner)
    含义: 动作执行的方式或态度
    中文表现形式: 副词或方式短语
    示例:
    - "仔细地"、"快速"、"小心翼翼"、"友好地"
    
ArgM-CAU (原因/Cause)
    含义: 导致动作发生的原因
    中文表现形式: "由于"、"因为"、"受...影响"
    示例:
    - "由于下雨"、"因为生病"、"受伤"
    
ArgM-PRP (目的/Purpose)
    含义: 执行动作的目的或意图
    中文表现形式: "为了"、"以便"、"目的是"
    示例:
    - "为了学习"、"以便休息"、"为了赚钱"

ArgM-TLS (工具/Tool)
    含义: 执行动作使用的工具或手段
    中文表现形式: "用..."、"通过..."、"借助..."
    示例:
    - "用笔"、"通过电话"、"借助软件"、"用火"
    
ArgM-DIR (方向/Direction)
    含义: 动作的方向
    中文表现形式: 方向词
    示例:
    - "向东"、"从北到南"、"向前"、"往下"
    
ArgM-GOL (目的地/Goal)
    含义: 动作指向的终点或目标
    中文表现形式: "到..."、"去..."
    示例:
    - "到北京"、"去医院"、"向目标"
    
ArgM-SRC (来源/Source)
    含义: 动作的起源或出发点
    中文表现形式: "从..."、"来自..."
    示例:
    - "从家里"、"来自日本"、"从头开始"
    
ArgM-NEG (否定/Negation)
    含义: 表示否定的标记
    中文表现形式: "没有"、"不"、"无法"
    示例:
    - "不做"、"没有完成"、"无法解决"
    
ArgM-MOD (情态/Modal)
    含义: 表示可能性、必要性、能力等的情态动词或副词
    中文表现形式: "可能"、"应该"、"必须"、"可以"
    示例:
    - "可能会下雨"、"应该去"、"必须完成"、"能够做到"
    
ArgM-EXT (范围/Extent)
    含义: 动作发生的范围或程度
    中文表现形式: "一直到"、"大约"
    示例:
    - "持续3小时"、"增加了50%"
    
ArgM-ATT (属性/Attribute)
    含义: 对论元的属性描述
    中文表现形式: 形容词或属性短语
    示例:
    - "新的"、"红色的"、"大的"、"漂亮的"
    
ArgM-FRQ (频率/Frequency)
    含义: 动作发生的频率
    中文表现形式: "经常"、"有时"、"从不"、"每次"
    示例:
    - "每天"、"经常"、"有时候"、"很少"
"""


# ============================================================================
# 第二部分: FrameNet语义框架
# ============================================================================

"""
FrameNet定义的语义框架通过"框架"(Frame)和"角色"(Role)来组织知识。

=== 核心角色 (Core Frame Elements) ===

Agent - 施事者
    定义: 有意执行动作的实体
    对应PropBank: ARG0
    示例:
    - "小明跑步。" → 小明 = Agent
    
Patient - 受事者
    定义: 直接受到动作影响的实体
    对应PropBank: ARG1
    示例:
    - "她读了这本书。" → 这本书 = Patient
    
Experiencer - 经历者
    定义: 经历心理或身体事件的实体
    对应PropBank: ARG0 (在感知动词中)
    示例:
    - "他喜欢音乐。" → 他 = Experiencer
    
Instrument - 工具/手段
    定义: 用来执行动作的工具
    对应PropBank: ARG2, ArgM-TLS
    示例:
    - "她用笔写字。" → 笔 = Instrument
    
Goal/Destination - 目标/目的地
    定义: 动作指向的终点
    对应PropBank: ARG4, ArgM-GOL
    示例:
    - "他走到门口。" → 门口 = Goal
    
Source - 来源/起点
    定义: 动作的起源点
    对应PropBank: ARG3, ArgM-SRC
    示例:
    - "她来自北京。" → 北京 = Source
    
Location - 地点
    定义: 动作发生的地点
    对应PropBank: ArgM-LOC
    示例:
    - "我在公园跑步。" → 公园 = Location
    
Time - 时间
    定义: 动作发生的时间
    对应PropBank: ArgM-TMP
    示例:
    - "她每天早上跑步。" → 每天早上 = Time
    
=== 外周角色 (Peripheral Frame Elements) ===

Manner - 方式
    定义: 动作执行的方式
    对应PropBank: ArgM-MNR
    
Means - 手段
    定义: 用来实现目的的方式
    
Degree - 程度/强度
    定义: 动作的程度
    对应PropBank: ArgM-EXT
    
Duration - 持续时间
    定义: 动作持续的时间长度
    
Frequency - 频率
    定义: 动作重复的频率
    对应PropBank: ArgM-FRQ
    
Purpose - 目的
    定义: 执行动作的目的
    对应PropBank: ArgM-PRP
    
Reason - 理由/原因
    定义: 导致动作发生的原因
    对应PropBank: ArgM-CAU
    
Result - 结果
    定义: 动作导致的结果
"""


# ============================================================================
# 第三部分: Triplet-Qwen系统中的语义角色映射
# ============================================================================

"""
在Triplet-Qwen系统中，我们采用以下映射:

Subject (ARG0/Agent)
    - PropBank: ARG0
    - FrameNet: Agent, Experiencer
    - 中文: 主语、施事者
    - 在三元组中位置: Predicate(Subject, ...)
    
Object (ARG1/Patient)
    - PropBank: ARG1
    - FrameNet: Patient, Theme, Experiencer (某些情况)
    - 中文: 宾语、受事者
    - 在三元组中位置: Predicate(..., Object)
    
Modifiers (修饰语):
    下列语义角色表示为字典形式: {key="value"}
    
    time = 时间 (ARG-TMP)
    location = 地点 (ARG-LOC)
    manner = 方式 (ARG-MNR)
    cause = 原因 (ARG-CAU)
    purpose = 目的 (ARG-PRP)
    tool = 工具 (ARG-TLS)
    direction = 方向 (ARG-DIR)
    destination = 目的地 (ARG-GOL)
    source = 来源 (ARG-SRC)
    attribute = 属性 (ARG-ATT)
    modal = 情态 (ARG-MOD)
    negation = 否定 (ARG-NEG)
    frequency = 频率 (ARG-FRQ)
    degree = 程度 (ARG-EXT)
    
=== 完整三元组示例 ===

句子: "她用钉子在木门上仔细地钉住了钉子。"
分析:
  - Subject (ARG0): 她 - Agent
  - Object (ARG1): 钉子 - Patient
  - Predicate: 钉住 - Action
  - Modifiers:
    * tool (ARG2/ARG-TLS): 用钉子 - Instrument
    * location (ARG-LOC): 在木门上 - Location
    * manner (ARG-MNR): 仔细地 - Manner

三元组表示:
{tool="用钉子", location="在木门上", manner="仔细地"} 钉住(她, 钉子)

"""


# ============================================================================
# 第四部分: 抽取规则和最佳实践
# ============================================================================

"""
=== 何时包含修饰语 ===

1. 只包含能够通过三元组恢复原句语义的修饰语
2. 不要过度抽取细节（如形容词修饰名词的情况）
3. 专注于影响谓词语义的修饰语
4. **重要**：对主语(Subject)或宾语(Object)的属性描述不应提取为修饰语，应保留在论元中

示例:
✓ "我在公园里仔细地阅读了一本很厚的书。"
  → {location="在公园", manner="仔细"} 阅读(我, 一本很厚的书)
  说明: 不需要 {attribute="很厚的"}，因为那是对Object的描述；但Object本身应保留"很厚的"

✓ "那个高大的男人在远方的山上看到了一只鸟。"
  → {location="在远方的山上"} 看到(高大的男人, 一只鸟)
  说明: "高大的"是对Subject的属性描述，应保留在Subject中，不作为谓词修饰语

✗ "小红穿着漂亮的衣服去了北京。"
  → {attribute="漂亮的"} 去(小红, 北京)
  说明: "漂亮的"修饰衣服而非去的动作，且衣服是动作的工具/伴随方式，应分析为{tool="穿着漂亮的衣服"}或保持简单形式


=== 多个同类修饰语的处理 ===

如果有多个相同类型的修饰语，应该合并或只保留最关键的：

例: "她每个周末、每个假期都在图书馆学习。"
  → {frequency="每个周末、每个假期", location="在图书馆"} 学习(她, null)
  或
  → {frequency="经常（周末和假期）", location="在图书馆"} 学习(她, null)


=== 隐含主语和宾语 ===

中文常常省略主语和宾语，在这种情况下使用null：

例: "在公园里跑步。" (省略主语)
  → {location="在公园"} 跑步(null, null)

例: "写完了。" (省略宾语)
  → {} 写完(你, null)  // 隐含的"你"


=== 复杂结构 ===

对于复杂句子，应该分解为多个简单三元组：

例: "张三用刀在砧板上快速地切割了洋葱。"
  → {tool="用刀", location="在砧板上", manner="快速"} 切割(张三, 洋葱)
  
例: "虽然下雨，但他仍然坚持去公园跑步。"
  → 第1个三元组: {cause="虽然下雨", manner="仍然坚持"} 去(他, 公园)
  → 第2个三元组: {location="在公园"} 跑步(他, null)
  
"""


# ============================================================================
# 第五部分: PropBank vs FrameNet 对比
# ============================================================================

"""
┌─────────────────────────────────────────────────────────────────────────┐
│                    PropBank vs FrameNet                                  │
├─────────────────────────────────────────────────────────────────────────┤
│ 特性        │ PropBank                  │ FrameNet                        │
├─────────────────────────────────────────────────────────────────────────┤
│ 基础单位    │ 动词谓词                  │ 语义框架 (Frame)               │
│ 论元标注    │ ARG0-ARG5, ArgM-*        │ 框架元素 (FE)                  │
│ 焦点        │ 动词论证结构              │ 情境和参与者关系               │
│ 应用范围    │ 动词论证标注              │ 多种句法结构和语境             │
│ 粒度        │ 相对粗粒度                │ 相对细粒度                     │
│ 跨语言      │ 英文为主                  │ 多语言框架存在                 │
├─────────────────────────────────────────────────────────────────────────┤
│ 示例: "他用刀切割面包"                                                    │
├─────────────────────────────────────────────────────────────────────────┤
│ PropBank:                           │ FrameNet:                        │
│ 切割.01 (cut.01):                   │ Frame: Cutting                  │
│ ARG0: 他 (Agent)                    │ Agent: 他                       │
│ ARG1: 面包 (Theme)                  │ Patient: 面包                   │
│ ARG2: 用刀 (Instrument)             │ Instrument: 刀                  │
│                                     │ Location: [not marked]          │
├─────────────────────────────────────────────────────────────────────────┤
│ Triplet-Qwen 统一表示:                                                    │
│ {tool="用刀"} 切割(他, 面包)                                             │
└─────────────────────────────────────────────────────────────────────────┘
"""


# ============================================================================
# 第六部分: 常见错误及改正
# ============================================================================

"""
=== 错误示例1: 遗漏重要修饰语 ===

句子: "小李每个工作日都在办公室里认真地处理客户投诉。"

错误: {} 处理(小李, 客户投诉)
说明: 遗漏了时间、地点和方式

正确: {frequency="每个工作日", location="在办公室", manner="认真"} 处理(小李, 客户投诉)


=== 错误示例2: 包含无关信息 ===

句子: "那个高大的男人在远方的山上看到了一只鸟。"

错误: {attribute="高大的", location="在远方的山上"} 看到(男人, 鸟)
说明: "高大的"修饰"男人"但不应该提取为修饰语；location应该完整保留

正确: {location="在远方的山上"} 看到(高大的男人, 一只鸟)
说明: 
  • "高大的"是对Subject的描述，不是对"看到"动作的修饰，应保留在Subject中
  • location修饰语应该完整提取"在远方的山上"，不应简化
  • Object应该保留完整的"一只鸟"


=== 错误示例3: 谓词识别错误 ===

句子: "他决定去公园跑步。"

错误: {location="在公园"} 决定(他, 去公园跑步)
说明: 过于复杂，应该分解

正确:
  - {purpose="去公园跑步"} 决定(他, null)
  - {location="在公园"} 跑步(他, null)


=== 错误示例4: 修饰语分类错误 ===

句子: "我通过努力完成了项目。"

错误: {location="通过努力"} 完成(我, 项目)
说明: "通过努力"是手段(tool/means)而非地点

正确: {tool="通过努力"} 完成(我, 项目)

"""

if __name__ == "__main__":
    print("语义角色参考手册")
    print("=" * 80)
    print("\n本文件包含:")
    print("1. PropBank语义角色标准 (ARG0-ARG5, ArgM-*)")
    print("2. FrameNet语义框架 (Frame Elements)")
    print("3. Triplet-Qwen系统中的语义角色映射")
    print("4. 抽取规则和最佳实践")
    print("5. PropBank vs FrameNet 对比")
    print("6. 常见错误及改正")
    print("\n请参考本文件中的详细定义和示例来理解和应用语义角色。")
